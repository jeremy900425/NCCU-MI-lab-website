# 依照各功能列出預計會使用到的 API( 可能重複 )
---

## 檔案上傳


#### 可能使用到的 API：
*上傳檔案原則：先透過 檔案上傳 API 請求 生成 Presigned URL API 後才會得到 URL，檔案上傳 API 回傳這個 URL 就可以上傳檔案*
| API 名稱                   | 主要用途                        | 使用說明                             |
|----------------------------|--------------------------------|--------------------------------------|
| AWS Cognito Auth API       | 使用者登入、驗證               | 驗證身份並生成 JWT                   |
| AWS S3 Presigned URL       | 生成簽名網址                   | 允許直接上傳檔案至 S3                |
| 檔案列表 API               | 取得檔案列表                  | 從 RDS 查詢使用者的檔案 meta data     |
| 檔案上傳 API               | 生成上傳用的簽名網址          | 驗證身份，返回 S3 Presigned URL       |
| 更新檔案 meta data API     | 儲存上傳完成的檔案資訊         | 上傳完成後，將檔案 meta data 存入 RDS |
| 通知 API           | 回報上傳狀態                  | 上傳成功或失敗通知，更新使用者介面    |

---
## 檔案刪除

#### 此功能預計使用的API
| API 名稱                    | 主要用途                              | 使用說明                                                                 |
|-----------------------------|---------------------------------------|--------------------------------------------------------------------------|
| AWS Cognito Auth API        | 使用者登入與身份驗證                 | 驗證使用者身份並生成 JWT Token                                          |
| 檔案列表 API                | 取得檔案列表                          | 查詢使用者上傳的所有檔案 meta data，包含檔案名稱、大小、上傳日期等       |
| 刪除檔案 API                | 刪除檔案至垃圾桶                      | 檢查 JWT Token，驗證刪除權限後，更新 RDS 的檔案狀態為「垃圾桶」         |
| AWS S3 Move Object API      | 移動檔案至垃圾桶資料夾                | 將檔案從主資料夾移至「垃圾桶」資料夾，避免在主檔案列表中顯示             |
| 通知 API                    | 刪除操作通知                          | 返回刪除成功訊息至前端，更新檔案管理介面                                  |
| 垃圾桶檔案列表 API          | 查詢垃圾桶中的檔案列表                | 從 RDS 查詢所有被刪除但未永久刪除的檔案資訊，包含刪除日期等             |
| AWS Lambda 定期清理 API      | 定期清理垃圾桶中超過30天的檔案       | 使用 AWS Lambda 每日掃描 RDS，刪除垃圾桶中超過30天的檔案，並更新 RDS     |
| AWS S3 Delete Object API    | 永久刪除 S3 中的檔案                 | Lambda 調用該 API 永久刪除超過30天的檔案，並更新 RDS 將記錄標記為已刪除 |

---
## 預覽檔案
#### 可能使用到的API
| API 名稱                    | 主要用途                              | 使用說明                                                                 |
|-----------------------------|---------------------------------------|--------------------------------------------------------------------------|
| AWS Cognito Auth API        | 使用者登入與身份驗證                 | 確保使用者具備預覽檔案的權限                                            |
| 檔案列表 API                | 取得檔案列表                          | 查詢使用者上傳的檔案 meta data（如名稱、大小、類型等）                    |
| 請求預覽 API                | 請求預覽檔案                          | 驗證 JWT Token，確認使用者對檔案的預覽權限，並生成 S3 簽名網址            |
| AWS S3 Presigned URL        | 生成預覽用的簽名網址                 | 允許 Client 透過 URL 存取檔案內容進行預覽                                 |
---
## 已加星號


#### 可能使用到的 API
| API 名稱                    | 主要用途                              | 使用說明                                                                 |
|-----------------------------|---------------------------------------|--------------------------------------------------------------------------|
| AWS Cognito Auth API        | 使用者登入與身份驗證                 | 確保使用者具備加星或移除星號的權限                                      |
| 檔案列表 API                | 取得檔案列表                          | 查詢使用者上傳的檔案 meta data（如名稱、大小、類型、加星狀態等）          |
| 更新加星狀態 API            | 更新檔案加星狀態                      | 接收檔案 ID 和加星狀態，更新 RDS 中的檔案 meta data                       |
| 加星檔案列表 API            | 查詢加星檔案                          | 從 RDS 查詢加星狀態為 `true` 的檔案，顯示於檔案管理介面的篩選區域         |
---

## 生成外部下載連結
#### 可能使用到的API
| API 名稱                    | 主要用途                              | 使用說明                                                                 |
|-----------------------------|---------------------------------------|--------------------------------------------------------------------------|
| 檔案列表 API                | 取得檔案列表                          | 查詢使用者上傳的檔案 meta data（如名稱、大小、類型等）                    |
| 生成分享連結 API            | 生成外部下載連結並保存密碼和有效期限     | 接收密碼和有效期，並保存至資料庫                                         |
| 密碼驗證 API                | 驗證外部使用者輸入的密碼和有效期限      | 從資料庫檢查密碼是否正確且未過期，若正確則生成 S3 簽名網址               |
| AWS S3 Presigned URL        | 生成檔案下載的簽名網址                | 允許外部使用者在密碼驗證後存取檔案                                       |

